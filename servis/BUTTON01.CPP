#include <string.h>
#include <stdlib.h>
#include "button.hpp"

const B_OFF = 0;       //константы состояния клавиши
const B_ON  = 1;       //
const B_ACT = 0x8000;  //
unsigned char  MARKER[][8]={
{0xf8,0xe0,0xb0,0x98,0x0c,0x06,0x03,0x01}, //	0
{0x18,0x3c,0x5a,0x18,0x18,0x18,0x18,0x18}, //	1
{0x1f,0x07,0x0d,0x19,0x30,0x60,0xc0,0x80}, //	2
{0x00,0x20,0x40,0xff,0xff,0x40,0x20,0x00}, //	3
{0x00,0x04,0x02,0xff,0xff,0x02,0x04,0x00}, //	4
{0x01,0x03,0x06,0x0c,0x98,0xb0,0xe0,0xf8}, //	5
{0x18,0x18,0x18,0x18,0x18,0x5a,0x3c,0x18}, //	6
{0x80,0xc0,0x60,0x30,0x19,0x0d,0x07,0x1f}, //	7
{0x00,0x08,0xfc,0x10,0x20,0xfc,0x40,0x00}, //<>	8
{0x60,0x30,0x18,0x0c,0x19,0x32,0x64,0x08}, //>=	9
{0x06,0x0c,0x18,0x30,0x98,0x4c,0x26,0x00}  //<=	10
};
pascal but_mark::but_mark(int left,int top,int right,int bot,int key,char *text) :
  button(left,top,right,bot,key,text) {};
pascal but_mark::but_mark(int key,char *text) : button(key,text)  {};

void but_mark::draw(int on) {
  SVS svs;savesettings(&svs);
   int len=strlen(text),on1=on & B_ON;
   int x = (right + left)/2+1 + on1 -4*len,
	  y = (bot   + top - 6)/2;
   int i;

// блик button
   setcolor(WHITE);rectangle(left+1,top+1,right,bot);

// фон button
    setfillstyle(1,LIGHTGRAY);bar(left+2, top+2, right, bot);
//  огранка button
    setcolor(BLACK);rectangle(left,top,right,bot);
    rectangle(left+on1, top+on1, right-on1, bot-on1);
//  надпись button
    if (on & B_ACT) setcolor(WHITE); else setcolor(BLACK);
    for (i=0;i<len;i++,x+=8) 
      putmarker_8_n(x,y,8,MARKER[text[i]-1]);
    restoresettings(&svs);  
}
